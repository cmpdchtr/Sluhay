#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑—É–ø–∏–Ω–∫–∏ –≤—Å—ñ—Ö –∑–∞–ø—É—â–µ–Ω–∏—Ö –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ –±–æ—Ç–∞
# –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü–µ —è–∫—â–æ –æ—Ç—Ä–∏–º—É—î—Ç–µ –ø–æ–º–∏–ª–∫—É "Conflict: terminated by other getUpdates request"

echo "üîç –ü–æ—à—É–∫ –∑–∞–ø—É—â–µ–Ω–∏—Ö –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ –±–æ—Ç–∞..."

# –®—É–∫–∞—î–º–æ –ø—Ä–æ—Ü–µ—Å–∏ Python, —è–∫—ñ –∑–∞–ø—É—Å–∫–∞—é—Ç—å main.py
PIDS=$(ps aux | grep "[p]ython.*main.py" | awk '{print $2}')

if [ -z "$PIDS" ]; then
    echo "‚úÖ –ù–µ–º–∞—î –∑–∞–ø—É—â–µ–Ω–∏—Ö –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ –±–æ—Ç–∞"
else
    echo "‚ö†Ô∏è  –ó–Ω–∞–π–¥–µ–Ω–æ –∑–∞–ø—É—â–µ–Ω—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏:"
    ps aux | grep "[p]ython.*main.py"
    
    echo ""
    read -p "–ó—É–ø–∏–Ω–∏—Ç–∏ –≤—Å—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏? (y/n) " -n 1 -r
    echo
    
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        for PID in $PIDS; do
            kill -9 $PID
            echo "‚úÖ –ó—É–ø–∏–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ—Å PID: $PID"
        done
        echo "‚ú® –í—Å—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏ –∑—É–ø–∏–Ω–µ–Ω–æ!"
    else
        echo "‚ùå –°–∫–∞—Å–æ–≤–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º"
    fi
fi

echo ""
echo "–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –±–µ–∑–ø–µ—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞:"
echo "python3 main.py"
